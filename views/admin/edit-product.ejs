<%- include('../includes/head.ejs') %>
    <link rel="stylesheet" href="/css/forms.css">
    <link rel="stylesheet" href="/css/product.css">
</head>

<body>
   <%- include('../includes/navigation.ejs') %>

    <main>
				<% if (errorMessage) { %>
					<div class="user-message user-message--error"><%= errorMessage %> </div>
				<% } %>
        <form class="product-form" action="/admin/<% if(editing) {%>edit-product<%}else{ %>add-product<%}%>" method="POST">
					<h1><% if(editing) {%>Edit Product<%}else{ %>Add new product<%}%></h1>
            <div class="form-control">
                <input 
								class="<%= validationErrors.find(e => e.param ==='title')?'invalid':'' %> "
								type="text" 
								name="title" 
								id="title" 
								placeholder="Title"
								value = "<% if(editing||hasError) {%><%=product.title%><%}%>">
            </div>
            <div class="form-control">
                <input type="text" 
								class="<%= validationErrors.find(e => e.param ==='imageUrl')?'invalid':'' %> "
								name="imageUrl" 
								id="imageUrl" 
								placeholder="Image URL"
								value = "<% if(editing||hasError) {%><%=product.imageUrl%><%}%>">
            </div>
            <div class="form-control">
                <input 
								class="<%= validationErrors.find(e => e.param ==='price')?'invalid':'' %> "
								type="number" 
								name="price" 
								id="price" 
								placeholder="Price"
								step="0.01"
								value = "<% if(editing||hasError) {%><%=product.price%><%}%>">
							</div>
							<div class="form-control">
                <textarea 
									class="<%= validationErrors.find(e => e.param === 'description') ? 'invalid' : '' %>"
									name="description" 
									id="description" 
									placeholder="Description of product"
									rows="5"
									><% if (editing || hasError) { %><%= product.description %><% } %></textarea>
            </div>
			<% if(editing) { %>
				<input type="hidden" name="productId" value="<%= product._id%>">
			<% } %>
						<input type="hidden" name="_csrf" value="<%= csrfToken %>">
            <button class="btn update" type="submit"><% if(editing) {%>Update Product<%}else{ %>  Add Product<%}%></button>
        </form>
    </main>
<%- include('../includes/end.ejs') %>